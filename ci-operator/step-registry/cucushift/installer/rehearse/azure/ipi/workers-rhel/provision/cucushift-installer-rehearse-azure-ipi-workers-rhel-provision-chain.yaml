chain:
  as: cucushift-installer-rehearse-azure-ipi-workers-rhel-provision
  steps:
  - ref: ipi-conf
  - ref: ipi-conf-azure
  - ref: ipi-conf-azure-resourcegroup
  - ref: ipi-install-monitoringpvc
  - ref: ipi-install-rbac
  - ref: ipi-install-install
  - ref: ipi-install-times-collection
  - ref: ssh-bastion
  - ref: workers-rhel-azure-provision
  - chain: workers-rhel
  env:
  - name: RHEL_WORKER_COUNT
    default: 2
    documentation: The number of rhel worker to be provisioned.
  - name: RHEL_IMAGE
    default: "8.5.2021121504"
    documentation: |-
      The name of rhel vm/template used to clone RHEL instances
  - name: RHEL_IMAGE_SKU
    default: "8-lvm-gen2"
    documentation: |-
      The name of rhel image SKU used to clone RHEL instances
  - name: PLATFORM_VERSION
    default:  "8.3"
    documentation: "RHEL node version"
  - name: RHEL_USER
    default: "cloud-user"
    documentation: |-
      The user to login the system of RHEL instance
  - name: REMOVE_RHCOS_WORKER
    default: "no"
    documentation: |-
      Keep or remove rhcos worker after scaling up rhel worker
  documentation: |-
    Create a IPI cluster with RHEL worker nodes on Azure for QE e2e tests.
